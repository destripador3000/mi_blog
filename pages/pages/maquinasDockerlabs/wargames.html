<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Terminal | Destripador3000</title>
  <link rel="stylesheet" href="../../assets/css/style.css"/>
</head>
<body>
  <div class="terminal">

    <div class="prompt">
      <a href="../ciberseguridad.html"><span class="green">destripador3000@Dockerlabs</span></a>:<span class="blue">~</span>$echo wargames

      <h2>Máquina Wargames</h2>  
      <pre class="content">Los servicios encontrados con puertos abiertos en la máquina son:</pre>
      <img src="../../assets/img/imagen1.png" alt="Wargames imagen1">
      <pre class="content">Al revisar el puerto 80 en el cual esta corriendo un sitio web. Nos da el siguiente mensaje lo cual puede ser un indicio de que los vectores de ataque de la máquina son más básicos.
      </pre>
      <img src="../../assets/img/imagen2.png" alt="Wargames imagen2">
        <pre class="content">Al hacer un enumeración de directorios con gobuster encontramos un archivo README.txt y un index.html el cual sabemos que es la página principal del sitio web en la que esta el mensaje que aparecio antes.</pre>
      <img src="../../assets/img/imagen3.png" alt="Wargames imagen3">
      <pre class="content">Encontramos dos nombres de posibles usuarios falken y joshua además de una instrucciones de comando para lo que parece ser un juego además de una pista significativa de que en algun sitio de la máquina hay una shell para ejecutar código.</pre>
      <img src="../../assets/img/imagen4.png" alt="Wargames imagen4">
      <pre class="content">Como vimos anteriormente, en los servicios estaba abierto el puerto 5000 en el que corre un servicio upnp y el puerto 21 en el que corre un servicio ftp en el ftp hice muchas pruebas y me rendi así que intente conectarme a través de nc al 5000 y salio esto. Al principio intente ejecutar comandos comunes pero no funciono. Hasta que recorde los comandos del README.txt y los utilice.</pre>
      <img src="../../assets/img/imagen5.png" alt="Wargames imagen5">
      <pre class="content">Empece a jugar algunos minijuegos que estaban allí solo se podian 3 sin embargo el único que parecia un juego era el TIC-TAC-TOE. Decidi emplear el comando help y salio que puedo ejecutar el comando logon Joshua.</pre>
      <img src="../../assets/img/imagen6.png" alt="Wargames imagen6">
       <pre class="content">Al ejecutar el comando logon Joshua, muestra el mensaje "GREETINGS PROFESSOR FALKEN.". Pensé que de esa manera obtendría acceso a una shell pero no fue así probe con comandos nuevos y no. Al investigar un poco en internet me entere que wargames es una película antigua que habla sobre el uso de una inteligencia artificial para ayudar al mundo a tomar decisiones en la guerra. Así que deduje que estaba en el prompt de una IA, al llegar a esta conclusión busque exploits de prompt injection y después de un rato practicando obtuve algo al preguntarle "Who are you?" se obtiene una respuesta diferente al igual si se introduce "What is your purpose". Al corroborar que si es una especie de IA empece a introducir comandos para obtener el GODMODE especificado en el README.txt. Y lo logre.</pre>
      <img src="../../assets/img/imagen7.png" alt="Wargames imagen7">
       <pre class="content">Obtuve un hash del usuario Joshua y utilice la herramienta hash-identifier para saber con que clase de hash estaba tratando era un SHA-256.Aquí debo admitir que me quede en un loop intentando usar john the ripper para crackear la contraseña. Sin embargo decidi intentar con varios sitios en internet y saber cual daba con un crackeo exitoso. La herramienta crackStation por ejemplo no me funciono pero <a href="https://hashes.com/en/decrypt/hash" alt="link decrypt hashes">Decrypt hashes</a> lo hizo en un abrir y cerrar de ojos dando la contraseña del usuario Joshua y así poder entrar al servicio SSH.</pre>
      <img src="../../assets/img/imagen8.png" alt="Wargames imagen8">
      <img src="../../assets/img/imagen9.png" alt="Wargames imagen9">
      <img src="../../assets/img/imagen10.png" alt="Wargames imagen10">
      <pre class="content">Entramos a la máquina con el usuario y empezamos a movernos por ella. Como es usual en las máquinas de dockerlabs hay que escalar privilegios por lo que use lo más común "sudo -l" y "find / -type f -user root 2>/dev/null" este último mostrandome un binario muy interesante llamado godmode. Hay que decir que en el proceso de busqueda también encontre el códgio de la "IA" en el que corrian los juegos y que era un vector de ataque.</pre>
      <img src="../../assets/img/imagen11.png" alt="Wargames imagen11">
      <img src="../../assets/img/imagen12.png" alt="Wargames imagen12">
      <img src="../../assets/img/imagen13.png" alt="Wargames imagen13">
      <pre class="content">Descargamos el binario en nuestra máquina atacante, esto a través de un servidor levantado con python en la máquina víctima. Al descargarlo usamos la herramienta ghidra para annalizar su código de manera estática. Encontrandonos con la sorpresa de que la función main se puede ejecutar "/bin/bash" y escalar a root siempre y cuando se le pase el argumento --wopr al momento de ejecutar el código. Lo hicimos y... Somos root. Así acabamos esta máquina.</pre>
      <img src="../../assets/img/imagen14.png" alt="Wargames imagen14">
      <img src="../../assets/img/imagen15.png" alt="Wargames imagen15">
       <pre class="content">Para concluir se puede decir que esta máquina me fue un poco difícil en el aspecto de la IA y el prompt injection, además de crackear hashes ya que al no encontrar la contraseña me frustre un poco pero logre conseguirlo..</pre>

    <a href="https://www.linkedin.com/feed/">Juan Esteban Valencia (Destripador3000)</a>
     


    </div>

    <div class="content">
     
    </div>

    <div class="prompt">
     
    </div>



  </div>
</body>
</html>
